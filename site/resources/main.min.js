function addObject(e){var t="",n=e.objectType+"-"+e.objectWidth+"x"+e.objectHeight,r=e.objectX===0?1:e.objectX*gridSize,i=e.objectY*gridSize,s="texture-"+(e.objectTexture==="000"?"":e.objectTexture);t+="<div class='object "+n+"' style='left:"+r+"px; top:"+i+"px; z-index:"+e.objectZIndex+";'>";t+="<div>";t+="<div style='background-color:"+e.objectColor+";'>";t+="<div class='texture "+s+"'>";t+="</div>";t+="</div>";t+="</div>";t+="</div>";return t}function dragObjectsSetUp(){Draggable.create(".object",{type:"x,y",edgeResistance:.65,bounds:"#objectContainer",throwProps:!0,liveSnap:!0,snap:{x:function(e){return Math.round(e/gridSize)*gridSize},y:function(e){return Math.round(e/gridSize)*gridSize}}})}function renderObjects(){var e="";$.each(objectsArray.data,function(t,n){e+=addObject(n)});$("#objectContainer").append(e);dragObjectsSetUp()}function getObjectsData(e){$.post("getObjects.php",{data:e},function(e){if(e.complete>0){objectsArray=e;renderObjects()}})}var objectsArray,gridSize=40,$objectContainer=$("#objectContainer"),windowWidth=$(window).width(),windowHeight=$(window).height(),screenWidth=screen.width,screenHeight=screen.height,gridColumns=Math.floor(screenWidth/gridSize)+3,gridRows=Math.floor(screenHeight/gridSize)+3;for(var i=0;i<gridRows*gridColumns;i++){var y=Math.floor(i/gridColumns)*gridSize,x=i*gridSize%(gridColumns*gridSize);$("<div/>").css({position:"absolute",border:"1px solid #454545",width:gridSize-1,height:gridSize-1,top:y,left:x}).prependTo($objectContainer)}TweenLite.set($objectContainer,{height:gridRows*gridSize+1,width:gridColumns*gridSize+1});var queryString=function(){var e={},t=window.location.search.substring(1),n=t.split("&");for(var r=0;r<n.length;r++){var i=n[r].split("=");if(typeof e[i[0]]=="undefined")e[i[0]]=i[1];else if(typeof e[i[0]]=="string"){var s=[e[i[0]],i[1]];e[i[0]]=s}else e[i[0]].push(i[1])}return e}();queryString.location&&queryString.country?getObjectsData({localLocation:"false",location:queryString.location,country:queryString.country}):getObjectsData({localLocation:"true",location:userObject.location,country:userObject.country});$(window).load(function(){$("html, body").animate({scrollLeft:(gridColumns*gridSize-windowWidth)/2},{duration:1e3,queue:!1});$("html, body").animate({scrollTop:$(document).height()},{duration:1e3,queue:!1})});$(document).ready(function(){$("#dynamicAdd").click(function(){function e(e,t){return Math.floor(Math.random()*(t-e+1))+e}var t=["aqua","black","blue","fuchsia","gray","green","lime","maroon","navy","olive","orange","purple","red","silver","teal","yellow"],n=["square","circle","triangle-L","triangle-R"],r=["000","001","002"];userObject.userName="A";userObject.objectType=n[e(0,3)];userObject.objectWidth=e(1,4);userObject.objectHeight=e(1,4);userObject.objectX=e(1,8);userObject.objectY=e(1,8);userObject.objectColor=t[e(0,15)];userObject.objectTexture=r[e(0,2)];userObject.objectZIndex=0;JSON.stringify(userObject);$.post("postObject.php",{data:userObject},function(e){e.complete?$("#responseText").text(e.details):$("#responseText").text(e.details)});$objectContainer.append(addObject(userObject));dragObjectsSetUp()})});